{"version":3,"file":"Plugin.js","sourceRoot":"","sources":["../src2/Plugin.ts"],"names":[],"mappings":"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","sourcesContent":["'use babel';\n/*!\n * XAtom Debug\n * Copyright(c) 2017 Williams Medina <williams.medinaa@gmail.com>\n * MIT Licensed\n */\nconst { CompositeDisposable, Range, Emitter, Disposable } = require('atom');\nimport { ToolbarView } from './ToolbarView';\nimport { DebugControlView } from './DebugControlView';\nimport { DebugAreaView, DEBUG_AREA_URI } from './DebugAreaView';\nimport { DebugNavigatorView, DEBUG_NAVIGATOR_URI } from './DebugNavigatorView';\nimport { Breakpoint, BreakpointManager } from './Breakpoint';\n\nexport interface Plugin {\n  iconPath: string;\n}\n\nexport interface Session {\n  getScheme (): void;\n  start (): void;\n  end (): void;\n  status (options: {\n    text: string,\n    type?: 'error' | 'warning' | 'success',\n    loading: boolean\n  }): void;\n}\n\nexport class Location {\n  private lineMarker: any;\n  private lineNumberMarker: any;\n  private editor: any;\n  constructor (private location: Breakpoint) {\n    this.openEditor(location);\n  }\n  async openEditor (location: Breakpoint) {\n    this.editor = <any> await atom.workspace.open(location.filePath, {\n      initialLine: location.lineNumber || 0,\n      initialColumn: location.columnNumber || 0\n    });\n    this.editor\n      .getGutters()\n      .filter((gutter) => gutter.name !== 'line-number')\n      .forEach((gutter) => {\n        gutter.hide();\n      });\n    const range = new Range(\n      [location.lineNumber, location.columnNumber],\n      [location.lineNumber, location.columnNumber]);\n    this.lineMarker = this.editor.markBufferRange(range);\n    this.lineNumberMarker = this.editor.markBufferRange(range);\n    this.editor.decorateMarker(this.lineMarker, {\n      type: 'line',\n      class: 'xatom-debug-location'\n    });\n    this.editor.decorateMarker(this.lineNumberMarker, {\n      type: 'line-number',\n      class: 'xatom-debug-location'\n    });\n    atom.focus();\n  }\n  destroy () {\n    if (this.editor) {\n      this.editor\n        .getGutters()\n        .filter((gutter) => gutter.name !== 'line-number')\n        .forEach((gutter) => gutter.show());\n    }\n    if (this.lineMarker) this.lineMarker.destroy();\n    if (this.lineNumberMarker) this.lineNumberMarker.destroy();\n  }\n}\n\nexport function createSession (toolbarView,\n  debugControlView,\n  debugAreaView,\n  debugNavigatorView,\n  breakpointManager) {\n  let currentLocation;\n  return <Session> {\n    getScheme () {\n      const editor = atom.workspace.getCenter().getActivePaneItem();\n      if (!atom.workspace.isTextEditor(editor)) return;\n      return {\n        currentPath: editor.getPath()\n      };\n    },\n    getBreakpoints () {\n      return breakpointManager.getBreakpoints();\n    },\n    async location (location: Breakpoint) {\n      if (currentLocation) currentLocation.destroy();\n      currentLocation = new Location(location);\n    },\n    status (o): void  {\n      toolbarView.setStatusText(o.text);\n      toolbarView.setStatusLoading(o.loading || false);\n      toolbarView.setStatusState(o.type || '');\n    },\n    pause () {\n      debugControlView.enableControls();\n    },\n    resume () {\n      debugControlView.disableControls();\n    },\n    start (): void {\n      toolbarView.disableControls();\n      debugControlView.show();\n      atom.workspace.open(DEBUG_AREA_URI, {});\n      atom.workspace.open(DEBUG_NAVIGATOR_URI, {});\n    },\n    end (): void {\n      if (currentLocation) currentLocation.destroy();\n      toolbarView.enableControls();\n      debugControlView.hide();\n      atom.workspace.hide(DEBUG_AREA_URI);\n      atom.workspace.hide(DEBUG_NAVIGATOR_URI);\n    }\n  }\n}\n\nexport class PluginManager {\n  private emitter = new Emitter();\n  private activePlugin: Plugin;\n  public plugins: Array<any> = [];\n  constructor (\n    private toolbarView: ToolbarView,\n    private debugControlView: DebugControlView,\n    private debugAreaView: DebugAreaView,\n    private debugNavigatorView: DebugNavigatorView,\n    private breakpointManager: BreakpointManager) {}\n  execute (functionName: string, functionArgs?: any[]) {\n    const plugin = this.getActivePlugin();\n    if (plugin[functionName]) {\n      plugin[functionName].apply(plugin, functionArgs);\n    }\n  }\n  setActivePlugin (plugin: Plugin): void {\n    this.activePlugin = plugin;\n  }\n  getSession (): Session {\n    return createSession(\n      this.toolbarView,\n      this.debugControlView,\n      this.debugAreaView,\n      this.debugNavigatorView,\n      this.breakpointManager\n    );\n  }\n  getActivePlugin (): Plugin {\n    return this.activePlugin;\n  }\n  onDidChangePlugins (callback: Function) {\n    return this.emitter.on('didChangePlugins', callback);\n  }\n  addPlugin (name: string, plugin: any) {\n    const item = {\n      name,\n      plugin\n    };\n    this.plugins.push(item);\n    this.activePlugin = plugin;\n    this.emitter.emit('didChangePlugins', this.plugins);\n  }\n  removePlugin (pluginName: string) {\n    const index = this.plugins.findIndex((p) => p.name === pluginName);\n    if (index > -1) this.plugins.splice(index, 1);\n    this.emitter.emit('didChangePlugins', this.plugins);\n  }\n  destroy () {\n\n  }\n}\n"]}